"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.refizePointer = exports.query = void 0;
var jsonpath_plus_1 = require("jsonpath-plus");
/**
 * Run a set of JSONPath queries against an API definition.
 *
 * @see {@link https://jsonpath.com/}
 * @see {@link https://npm.im/jsonpath-plus}
 */
function query(queries, definition) {
    var results = queries
        .map(function (q) { return (0, jsonpath_plus_1.JSONPath)({ path: q, json: definition, resultType: 'all' }); })
        .filter(function (res) { return (res.length ? res : false); })
        .reduce(function (prev, next) { return prev.concat(next); }, []);
    // Always alphabetize our results by the JSON pointer.
    results.sort(function (a, b) {
        if (a.pointer < b.pointer) {
            return -1;
        }
        else if (a.pointer > b.pointer) {
            return 1;
        }
        return 0;
    });
    return results;
}
exports.query = query;
/**
 * Transform a JSON pointer into a JSON Schema `$ref`-compatible pointer.
 *
 * @example `/paths/~1streams/post/callbacks` -> `#/paths/~1streams/post/callbacks`
 */
function refizePointer(pointer) {
    return "#".concat(pointer);
}
exports.refizePointer = refizePointer;
